
This is a RunAs plugin for JetBrains TeamCity: http://www.jetbrains.com/teamcity/

With help of this plugin you can run builds under different user accounts or perform some additional actions before or after build process.


How To Build
==================

1) Download and install TeamCity version 6.5.3 or later (http://www.jetbrains.com/teamcity/download/index.html)
2) Download and install IntelliJ IDEA Community or Ultimate Edition (http://www.jetbrains.com/idea/download/index.html)
3) Open project in IntelliJ IDEA
4) Choose Menu Build -> Build Artifacts
5) Select runas-plugin artifact from the menu
6) runas.zip file must be created in the project root


How To Install
==================

Copy runas.zip to .BuildServer/plugins and restart TeamCity server. This will cause automatic agents upgrade.


How To Use
============

* Open <agent inst dir>/conf/buildAgent.properties file for editing.
* Specify there additional property: teamcity.build.runAs.command
* This property has the following format:
<path to executable> <arg1> <arg2> ... <argN> {start_build_script}
where path to executable - is a path to some executable which will start the build process, the path must be quoted if it contains spaces
arg1, argN - arguments for this executable
{start_build_script} - path to a script (.cmd on Windows or .sh on Unix) generated by this plugin which contains command line to start build process

Examples:

* Run as different user account on Windows (psexec)

teamcity.build.runAs.command="C:\\Program Files\\SysInternals\\psexec.exe" -u %runas.username% -p %runas.password% {start_build_script}

Note that in this case %runas.username% and %runas.password% will be substituted to real values provided in the build. For example, you can defined values for these parameters in a TeamCity project.

* Run as different user account on Linux (sudo)

teamcity.build.runAs.command=/bin/bash -c "echo %runas.password% | sudo -S -u %runas.username% {start_build_script}"


License
==========

Apache License 2.0


Author
========

Pavel Sher (pavel.sher@gmail.com)

